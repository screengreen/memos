# RAG‚Äë–ø—Ä–æ–µ–∫—Ç –ø–æ –∫–Ω–∏–≥–µ 

## 1) –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏ 
**–¶–µ–ª—å:** –ø–æ–ª—É—á–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–µ, –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã–µ –æ—Ç–≤–µ—Ç—ã —Ç–æ–ª—å–∫–æ –∏–∑ –æ—Ü–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–π –∫–Ω–∏–≥–∏ –ø–æ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–∞–º/–ø—Ä–æ–¥–∞–∂–∞–º/–¥–µ–π—Ç–∏–Ω–≥—É.
- –ê–≥–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –∞ –Ω–µ –∏–∑ –ø–∞–º—è—Ç–∏
- –û—Ç–≤–µ—Ç—ã –±–µ–∑ —Ñ–∞–Ω—Ç–∞–∑–∏–π: –µ—Å–ª–∏ –Ω–µ—Ç —Ñ–∞–∫—Ç–∞ –≤ —Ç–µ–∫—Å—Ç–µ ‚Äî –ø–∏—Å–∞—Ç—å ¬´–ù–µ –Ω–∞—à—ë–ª –≤ –ø–∞–º—è—Ç–∏¬ª
- Retrieveal —É–º–µ–µ—Ç –≤–æ–∑–≤—Ä–∞—â—è—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤–µ—Å—å –∑–∞–ø—Ä–æ—Å, –∞ –Ω–µ –µ–≥–æ —á–∞—Å—Ç—å
- –≤ –æ—Ç–≤–µ—Ç–µ –±—ã–ª–∏ –±—ã —Ü–∏—Ç–∞—Ç—ã –∏–ª–∏ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏–µ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∫—É—Å–∫–∏ —Ç–µ–∫—Å—Ç–∞
- –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä—É—Å—Å–∫–∏–π –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π, –∞ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —è–∑—ã–∫–µ –≤–æ–ø—Ä–æ—Å–∞

---

## 2) –ü–ª–∞–Ω vs —Ñ–∞–∫—Ç 
| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–∞–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª | –ß—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å |
|---|---|---|
| –§–∞–∫—Ç—ã/–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è | –¢–æ—á–Ω–æ, —Å–æ —Å—Å—ã–ª–∫–∞–º–∏ | ‚úîÔ∏è –°—Ç–∞–±–∏–ª—å–Ω–æ | 
| –°—Ä–∞–≤–Ω–µ–Ω–∏—è | –ë–∞–ª–∞–Ω—Å 2+ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ | ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–¥–Ω–æ–±–æ–∫–æ, –≤–∏–¥–∏—Ç –∏–Ω–æ–≥–¥–∞ —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ | 
| –ü—Ä–∏–º–µ—Ä—ã| –ü—Ä—è–º—ã–µ —Ü–∏—Ç–∞—Ç—ã –∏–ª–∏ –æ–∫–æ–ª–æ –∫–æ–ø–∏—è | ‚ö†Ô∏è –ë—ã–≤–∞–µ—Ç –ø–µ—Ä–µ—Ñ—Ä–∞–∑ | 
| ¬´–ù–µ—Ç –≤ –∫–Ω–∏–≥–µ¬ª | –≤—ã–¥–∞—á–∞ "–Ω–µ –∑–Ω–∞—é", –µ—Å–ª–∏ –Ω–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ | ‚ö†Ô∏è –ù–µ –≤—Å–µ–≥–¥–∞ | 
| –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å, –Ω–µ –º–µ—à–∞—é—â–∞—è –∫–∞—á–µ—Å—Ç–≤—É | –ü–æ—Ö–æ–∂–∏–µ –æ—Ç–≤–µ—Ç—ã | ‚ö†Ô∏è –°–ª–µ–≥–∫–∞ –ø–ª–∞–≤–∞–µ—Ç | 
|–ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å| –ï—Å—Ç—å| ‚úîÔ∏è –ï—Å—Ç—å|
|–æ—Ç–≤–µ—Ç –Ω–∞ —è–∑—ã–∫–µ –≤–æ–ø—Ä–æ—Å–∞| –ï—Å—Ç—å| ‚ö†Ô∏è –µ—Å—Ç—å, –Ω–æ –∏–Ω–æ–≥–¥–∞ –ø—É—Ç–∞–µ—Ç—Å—è –≤ —è–∑—ã–∫–∞—Ö|
|–≤—Å–µ retreveal —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ| –ù–µ—Ç| mem OS –ø–ª–æ—Ö–æ –æ—Ç—Ä–∞–±–∞—Ç—ã–∞–≤–µ—Ç|

---

## 3) –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ü–µ–Ω–∫–∏ retrieval (–≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –ª–µ–∂–∞—Ç –≤ –Ω–æ—É—Ç–±—É–∫–µ –≤ –≤—ã–≤–æ–¥–µ —è—á–µ–π–∫–∏)
–î–ª—è –ø—Ä–æ—Å—á—ë—Ç–∞ –º–µ—Ç—Ä–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ 550 –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤ (`qas.pkl`).

| –ú–µ—Ç–æ–¥   | Hit@1 | Hit@5 | Hit@10 | Hit@20 | Recall@5 | Recall@20 | MRR   | nDCG@5 | nDCG@20 |
|---------|-------|-------|--------|--------|----------|-----------|-------|--------|---------|
| **BM25**   | 0.481 | 0.642 | 0.705  | 0.769  | 0.642    | 0.769     | 0.557 | 0.569  | 0.605   |
| **Vec**    | 0.652 | 0.806 | 0.853  | 0.897  | 0.806    | 0.897     | 0.705 | 0.722  | 0.748   |
| **RRF**    | 0.650 | 0.851 | 0.897  | 0.944  | 0.851    | 0.944     | 0.737 | 0.759  | 0.786   |
| **Rerank** | **0.755** | **0.899** | **0.932** | **0.944** | **0.899** | **0.944** | **0.812** | **0.829** | **0.843** |

---

## üìù –í—ã–≤–æ–¥—ã
- **BM25** –æ—Å—Ç–∞—ë—Ç—Å—è —Å–∏–ª—å–Ω–æ–π –∏ –ø—Ä–æ—Å—Ç–æ–π –±–∞–∑–æ–π, –Ω–æ –∑–∞–º–µ—Ç–Ω–æ —É—Å—Ç—É–ø–∞–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–∞–º –ø–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É –º–µ—Ç—Ä–∏–∫.  
- **Vec (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫)** –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø—Ä–æ—à–ª—ã—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–∂–µ —Ö–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `Hit@1 = 0.652`, `MRR = 0.705`. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –º–æ–¥–µ–ª—å/–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è/—á–∞–Ω–∫–æ–≤–∞–Ω–∏–µ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –∫–æ—Ä–ø—É—Å–∞.  
- **RRF** (BM25+Vec) –¥–∞—ë—Ç –ø—Ä–∏—Ä–æ—Å—Ç –∫ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –Ω–∞ –¥–ª–∏–Ω–Ω–æ–º —Ö–≤–æ—Å—Ç–µ (`Recall@20 = 0.944`), –Ω–æ –Ω–µ —É–ª—É—á—à–∞–µ—Ç —Ç–æ–ø-1 –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —á–∏—Å—Ç–æ–≥–æ Vec.  
- **Rerank** –æ—Å—Ç–∞—ë—Ç—Å—è —É–≤–µ—Ä–µ–Ω–Ω–æ –ª—É—á—à–∏–º: –º–∞–∫—Å–∏–º—É–º –ø–æ –≤—Å–µ–º –∫–ª—é—á–µ–≤—ã–º –º–µ—Ç—Ä–∏–∫–∞–º (`Hit@1 = 0.755`, `MRR = 0.812`, `nDCG@20 = 0.843`). –ü–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–Ω–æ —É–ª—É—á—à–∞–µ—Ç –∫–∞—á–µ—Å—Ç–≤–æ –ø–µ—Ä–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π.  

---

## 4) –ì–∏–ø–æ—Ç–µ–∑—ã –∏ —É–ª—É—á—à–µ–Ω–∏—è

1) —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –æ–∫–æ–ª–æ –∫–æ–ø–∏–π, –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ "–Ω–µ –∑–Ω–∞—é", –ø–æ–≤—ã—Å–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ —Å–¥–µ–ª–∞—Ç—å –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ –æ—Ç–≤–µ—Ç–∞ –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–º:  
**–ü—Ä–æ–º–ø—Ç –∏ —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞** 
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É —Å–Ω–∏–∑–∏—Ç—å –¥–æ **0.2‚Äì0.3**; –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ: ¬´–∫–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç ‚Äî —Å **—Ü–∏—Ç–∞—Ç–æ–π**.  
- –£–ª—É—á—à–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–æ–º–ø—Ç–∞, –ª—É—á—à–µ –æ—Ñ–æ—Ä–º–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ–¥–∞—á–∏ —Ç–µ–∫—Å—Ç–∞ –≤ –º–æ–¥–µ–ª—å. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ —Ç–µ—Ö–Ω–∏–∫–∏ –ø—Ä–æ–º–ø—Ç
–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–∞, —Ç—É—Ç –¥—É–º–∞—é –æ—á–µ–Ω—å –º–Ω–æ–≥–æ —á–µ–≥–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å. 

2) –ß—Ç–æ–±—ã –±—Ä–∞—Ç—å –±–æ–ª–µ–µ —Ä–∞–∑–Ω–æ—à–µ—Ä—Å—Ç–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã:
- **MMR‚Äë–¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** –Ω–∞ —Ç–æ–ø‚ÄëN (–Ω–∞–ø—Ä–∏–º–µ—Ä, N=50 -> 10‚Äì15 —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏ –Ω–µ–ø–æ—Ö–æ–∂–∏—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤), —á—Ç–æ–±—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø–æ–¥—Ç—è–≥–∏–≤–∞–ª–∏ ¬´–æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã¬ª. (MMR (Maximal Marginal Relevance) –≤—ã–±–∏—Ä–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏ –∫ –∑–∞–ø—Ä–æ—Å—É, –Ω–æ –∏ –ø–æ **–Ω–µ–ø–æ—Ö–æ–∂–µ—Å—Ç–∏ –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞**.  –ø–µ—Ä–≤—ã–π —Ñ—Ä–∞–≥–º–µ–Ω—Ç ‚Äî —Å–∞–º—ã–π —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π. –í—Ç–æ—Ä–æ–π –≤—ã–±–∏—Ä–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã –æ–Ω –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –±—ã–ª, –∏ **–Ω–µ –ø–æ–≤—Ç–æ—Ä—è–ª** –ø–µ—Ä–≤—ã–π. –î–∞–ª—å—à–µ ‚Äî —Ç–æ –∂–µ –ø—Ä–∞–≤–∏–ª–æ.)
- –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑–±–∏–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—Å—ã, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–æ–¥–∏—Ç—å Retrieval, –∏ –±—Ä–∞—Ç—å –∏–∑ –∫–∞–∂–¥–æ–≥–æ –ø–æ n/–∫–æ–ª-–≤–æ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—Å–æ–≤ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤

3) –£–ª—É—á—à–µ–Ω–∏–µ reteiveal –≤ —Ü–µ–ª–æ–º (—Å—Ç–∞—Ç—å–∏ –Ω–∞ –ø–æ—á–∏—Ç–∞—Ç—å, –≤–Ω–µ–¥—Ä–∏—Ç—å ):
- **Pseudo‚ÄëRelevance Feedback (RM3/Bo1)** –ø–æ–≤–µ—Ä—Ö BM25 –¥–ª—è –¥–æ–±–∞–≤–∫–∏ —Ç–µ—Ä–º–∏–Ω–æ–≤.
- **Doc2Query / GPL**: —Ä–∞—Å—à–∏—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å –ø—Å–µ–≤–¥–æ‚Äë–≤–æ–ø—Ä–æ—Å–∞–º–∏.
- **HyDE**: —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ¬´–≥–∏–ø–æ—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç¬ª –ø–æ –≤–æ–ø—Ä–æ—Å—É –∏ –∏—Å–∫–∞—Ç—å –µ–≥–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–º ‚Äî —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å—é–∂–µ—Ç–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö –∏ –ø—Ä–∏–º–µ—Ä–∞—Ö –¥–∏–∞–ª–æ–≥–æ–≤.


---

## 5) –ö—Ä–∞—Ç–∫–æ –æ –ø–∞–π–ø–ª–∞–π–Ω–µ 
- **–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è:** `RecursiveCharacterTextSplitter` 
- **–ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫:** mem Os search + BM25.
- **–°–ª–∏—è–Ω–∏–µ:** RRF 
- **–†–µ—Ä–∞–Ω–∫:** `CrossEncoder("mmarco-mMiniLMv2-L12-H384-v1")` 
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è:** Mistral 
